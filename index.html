<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Login</title>
</head>
<body>

<h2>Login</h2>
<input id="user" placeholder="Usuario">
<input id="pass" type="password" placeholder="Contraseña">
<button onclick="login()">Entrar</button>

<script type="module">
import { auth, db } from "./firebase.js";
import { signInWithEmailAndPassword } from
  "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { doc, getDoc } from
  "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

window.login = async () => {
  const user = document.getElementById("user").value.trim();
  const pass = document.getElementById("pass").value;

  const emailFake = `${user}@proyects.com`;

  try {
    const cred = await signInWithEmailAndPassword(auth, emailFake, pass);
    const uid = cred.user.uid;

    const snap = await getDoc(doc(db, "users", uid));
    localStorage.setItem("uid", uid);
    localStorage.setItem("rol", snap.data().rol);

    location.href = "app.html";
  } catch {
    alert("Usuario o contraseña incorrectos");
  }
};
</script>

</body>
</html>




