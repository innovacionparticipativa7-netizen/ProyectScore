<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Proyectos</title>
</head>
<body>

<h2>Gestor de Proyectos</h2>
<p id="rol"></p>

<div id="admin"></div>
<hr>
<div id="proyectos"></div>
  
<h3>Nuevo Proyecto</h3>
<input type="text" id="nombreProyecto" placeholder="Nombre del proyecto">
<button onclick="crearProyecto()">Crear Proyecto</button>

<hr>

<h3>Proyectos</h3>
<ul id="listaProyectos"></ul>




  

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
  getFirestore,
  collection,
  addDoc,
  getDocs,
  doc,
  getDoc
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyAoVH8wQ2ofolAaJYdFnu1COcwI-xvaNnM",
  authDomain: "panel-proyectos-f119f.firebaseapp.com",
  projectId: "panel-proyectos-f119f"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* CREAR PROYECTO */
window.crearProyecto = async () => {
  const nombre = document.getElementById("nombreProyecto").value.trim();
  if (!nombre) {
    alert("Escribe un nombre");
    return;
  }

  await addDoc(collection(db, "proyectos"), {
    nombre,
    creado: new Date(),
    requisitos: []
  });

  document.getElementById("nombreProyecto").value = "";
  cargarProyectos();
};

/* LISTAR PROYECTOS */
async function cargarProyectos() {
  const lista = document.getElementById("listaProyectos");
  lista.innerHTML = "";

  const snap = await getDocs(collection(db, "proyectos"));
  snap.forEach(docu => {
    const li = document.createElement("li");
    li.textContent = docu.data().nombre;
    li.style.cursor = "pointer";

    li.onclick = () => cargarProyecto(docu.id);

    lista.appendChild(li);
  });
}

/* CARGAR UN PROYECTO */
async function cargarProyecto(id) {
  const ref = doc(db, "proyectos", id);
  const snap = await getDoc(ref);

  if (snap.exists()) {
    alert("Proyecto cargado: " + snap.data().nombre);
    // aqu√≠ luego cargaremos requisitos
  }
}

/* INIT */
cargarProyectos();
</script>

</body>
</html>

